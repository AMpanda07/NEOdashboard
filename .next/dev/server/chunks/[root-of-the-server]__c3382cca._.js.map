{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/digital/OneDrive/Desktop/NEOdashboard/app/api/neos/route.ts"],"sourcesContent":["import { NextResponse } from 'next/server';\r\n\r\nexport async function GET(request: Request) {\r\n    const { searchParams } = new URL(request.url);\r\n    const today = new Date().toISOString().split('T')[0];\r\n    const startDate = searchParams.get('start_date') || today;\r\n    const endDate = searchParams.get('end_date') || today;\r\n\r\n    const apiKey = process.env.NASA_API_KEY || 'DEMO_KEY';\r\n    const url = `https://api.nasa.gov/neo/rest/v1/feed?start_date=${startDate}&end_date=${endDate}&api_key=${apiKey}`;\r\n\r\n    try {\r\n        const res = await fetch(url);\r\n\r\n        if (!res.ok) {\r\n            throw new Error(`NASA API returned status: ${res.status}`);\r\n        }\r\n\r\n        const data = await res.json();\r\n\r\n        // Enrich with Risk Scores and Alert Metadata\r\n        if (data.near_earth_objects) {\r\n            Object.keys(data.near_earth_objects).forEach(date => {\r\n                data.near_earth_objects[date] = data.near_earth_objects[date].map((neo: any) => {\r\n                    const diameter = neo.estimated_diameter.meters.estimated_diameter_max;\r\n                    const missDistance = parseFloat(neo.close_approach_data[0].miss_distance.kilometers);\r\n                    const isHazardous = neo.is_potentially_hazardous_asteroid;\r\n\r\n                    // Risk Score Calculation (0-100)\r\n                    // base score from diameter (max 40 points for 2km+)\r\n                    let score = Math.min((diameter / 2000) * 40, 40);\r\n\r\n                    // miss distance score (max 40 points for < 100k km)\r\n                    // closer = higher score\r\n                    const distanceScore = Math.max(0, 40 * (1 - missDistance / 10000000));\r\n                    score += distanceScore;\r\n\r\n                    // hazardous multiplier\r\n                    if (isHazardous) score += 20;\r\n\r\n                    const finalScore = Math.min(Math.round(score), 100);\r\n\r\n                    return {\r\n                        ...neo,\r\n                        risk_score: finalScore,\r\n                        alert_level: finalScore > 75 ? 'CRITICAL' : finalScore > 50 ? 'WARNING' : 'MODERATE'\r\n                    };\r\n                });\r\n            });\r\n        }\r\n\r\n        return NextResponse.json(data);\r\n    } catch (error: any) {\r\n        return NextResponse.json({ error: error.message }, { status: 500 });\r\n    }\r\n}\r\n"],"names":[],"mappings":";;;;AAAA;;AAEO,eAAe,IAAI,OAAgB;IACtC,MAAM,EAAE,YAAY,EAAE,GAAG,IAAI,IAAI,QAAQ,GAAG;IAC5C,MAAM,QAAQ,IAAI,OAAO,WAAW,GAAG,KAAK,CAAC,IAAI,CAAC,EAAE;IACpD,MAAM,YAAY,aAAa,GAAG,CAAC,iBAAiB;IACpD,MAAM,UAAU,aAAa,GAAG,CAAC,eAAe;IAEhD,MAAM,SAAS,QAAQ,GAAG,CAAC,YAAY,IAAI;IAC3C,MAAM,MAAM,CAAC,iDAAiD,EAAE,UAAU,UAAU,EAAE,QAAQ,SAAS,EAAE,QAAQ;IAEjH,IAAI;QACA,MAAM,MAAM,MAAM,MAAM;QAExB,IAAI,CAAC,IAAI,EAAE,EAAE;YACT,MAAM,IAAI,MAAM,CAAC,0BAA0B,EAAE,IAAI,MAAM,EAAE;QAC7D;QAEA,MAAM,OAAO,MAAM,IAAI,IAAI;QAE3B,6CAA6C;QAC7C,IAAI,KAAK,kBAAkB,EAAE;YACzB,OAAO,IAAI,CAAC,KAAK,kBAAkB,EAAE,OAAO,CAAC,CAAA;gBACzC,KAAK,kBAAkB,CAAC,KAAK,GAAG,KAAK,kBAAkB,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;oBAC/D,MAAM,WAAW,IAAI,kBAAkB,CAAC,MAAM,CAAC,sBAAsB;oBACrE,MAAM,eAAe,WAAW,IAAI,mBAAmB,CAAC,EAAE,CAAC,aAAa,CAAC,UAAU;oBACnF,MAAM,cAAc,IAAI,iCAAiC;oBAEzD,iCAAiC;oBACjC,oDAAoD;oBACpD,IAAI,QAAQ,KAAK,GAAG,CAAC,AAAC,WAAW,OAAQ,IAAI;oBAE7C,oDAAoD;oBACpD,wBAAwB;oBACxB,MAAM,gBAAgB,KAAK,GAAG,CAAC,GAAG,KAAK,CAAC,IAAI,eAAe,QAAQ;oBACnE,SAAS;oBAET,uBAAuB;oBACvB,IAAI,aAAa,SAAS;oBAE1B,MAAM,aAAa,KAAK,GAAG,CAAC,KAAK,KAAK,CAAC,QAAQ;oBAE/C,OAAO;wBACH,GAAG,GAAG;wBACN,YAAY;wBACZ,aAAa,aAAa,KAAK,aAAa,aAAa,KAAK,YAAY;oBAC9E;gBACJ;YACJ;QACJ;QAEA,OAAO,gJAAY,CAAC,IAAI,CAAC;IAC7B,EAAE,OAAO,OAAY;QACjB,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,OAAO,MAAM,OAAO;QAAC,GAAG;YAAE,QAAQ;QAAI;IACrE;AACJ"}}]
}